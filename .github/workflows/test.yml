name: Lab 6 - Connect React to Mock API CI

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

jobs:
  integrity-check:
    name: üîí Template Integrity Check
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # Full history needed to compare against initial commit

      - name: Verify protected files unchanged
        id: integrity
        run: |
          echo "## üîí Template Integrity Check" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          INTEGRITY_OK=true

          # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
          # Layer 1: SHA-256 checksum verification
          # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
          # These checksums are generated at template creation time.
          # To regenerate, run from the template repo root:
          #   sha256sum vitest.config.ts tsconfig.json src/setupTests.ts
          #
          # ‚ö†Ô∏è  INSTRUCTOR: Replace these placeholder values with actual checksums
          #     before distributing the template. See INSTRUCTOR_SETUP.md for details.
          # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

          echo "### Checksum Verification (SHA-256)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          declare -A EXPECTED_CHECKSUMS
          EXPECTED_CHECKSUMS=(
            ["vitest.config.ts"]="d5bbb271ecb8bec082028a5e9c60f5fc397b27ca62f8c286b5aaa129e8dc1c2c"
            ["tsconfig.json"]="3e8d1142c6e1c174caf48da033978653fd14bf3e8b34683d08331c8e3e027826"
            ["src/setupTests.ts"]="a46d66851af2c056e805fdd574bf5ec3adb1181c43c5e41f0a1c592e338afe64"
          )

          CHECKSUM_FAILURES=""

          for file in "${!EXPECTED_CHECKSUMS[@]}"; do
            expected="${EXPECTED_CHECKSUMS[$file]}"

            if [ ! -f "$file" ]; then
              echo "‚ùå \`$file\` ‚Äî **MISSING** (deleted from template)" >> $GITHUB_STEP_SUMMARY
              CHECKSUM_FAILURES="$CHECKSUM_FAILURES $file"
              INTEGRITY_OK=false
              continue
            fi

            actual=$(sha256sum "$file" | awk '{print $1}')

            if [ "$expected" = "REPLACE_WITH_ACTUAL_CHECKSUM" ]; then
              echo "‚ö†Ô∏è \`$file\` ‚Äî checksum not configured (instructor action needed)" >> $GITHUB_STEP_SUMMARY
            elif [ "$actual" = "$expected" ]; then
              echo "‚úÖ \`$file\` ‚Äî checksum matches" >> $GITHUB_STEP_SUMMARY
            else
              echo "‚ùå \`$file\` ‚Äî **MODIFIED** (checksum mismatch)" >> $GITHUB_STEP_SUMMARY
              echo "    Expected: \`${expected:0:16}‚Ä¶\`" >> $GITHUB_STEP_SUMMARY
              echo "    Actual:   \`${actual:0:16}‚Ä¶\`" >> $GITHUB_STEP_SUMMARY
              CHECKSUM_FAILURES="$CHECKSUM_FAILURES $file"
              INTEGRITY_OK=false
            fi
          done

          # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
          # Layer 2: Git history comparison
          # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
          # Compare protected files against the initial (root) commit.
          # This catches modifications even if checksums are also tampered with.

          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Git History Comparison" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          ROOT_COMMIT=$(git rev-list --max-parents=0 HEAD)
          GIT_DIFF_FAILURES=""

          PROTECTED_FILES=(
            "vitest.config.ts"
            "tsconfig.json"
            "src/setupTests.ts"
            ".github/workflows/test.yml"
          )

          for file in "${PROTECTED_FILES[@]}"; do
            if git diff --quiet "$ROOT_COMMIT" HEAD -- "$file" 2>/dev/null; then
              echo "‚úÖ \`$file\` ‚Äî matches template" >> $GITHUB_STEP_SUMMARY
            else
              echo "‚ùå \`$file\` ‚Äî **DIFFERS** from template commit" >> $GITHUB_STEP_SUMMARY
              GIT_DIFF_FAILURES="$GIT_DIFF_FAILURES $file"
              INTEGRITY_OK=false
            fi
          done

          # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
          # Layer 3: Coverage threshold verification
          # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
          # Parse vitest.config.ts to verify thresholds are ‚â• 90%.

          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Coverage Threshold Verification" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          THRESHOLD_OK=true

          for metric in statements branches functions lines; do
            value=$(grep -oP "${metric}:\s*\K[0-9]+" vitest.config.ts 2>/dev/null || echo "0")
            if [ "$value" -ge 90 ]; then
              echo "‚úÖ \`$metric\`: ${value}% (‚â• 90%)" >> $GITHUB_STEP_SUMMARY
            else
              echo "‚ùå \`$metric\`: ${value}% (**below 90%**)" >> $GITHUB_STEP_SUMMARY
              THRESHOLD_OK=false
              INTEGRITY_OK=false
            fi
          done

          # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
          # Summary
          # ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

          echo "" >> $GITHUB_STEP_SUMMARY

          if [ "$INTEGRITY_OK" = "true" ]; then
            echo "### ‚úÖ All integrity checks passed" >> $GITHUB_STEP_SUMMARY
            echo "integrity_ok=true" >> $GITHUB_OUTPUT
          else
            echo "### ‚ö†Ô∏è Integrity issues detected" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "One or more template files may have been modified. The instructor will review." >> $GITHUB_STEP_SUMMARY
            echo "integrity_ok=false" >> $GITHUB_OUTPUT
          fi

  test:
    runs-on: ubuntu-latest
    needs: integrity-check
    if: always()

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: Install dependencies
        run: npm ci

      - name: TypeScript check
        run: npm run typecheck

      - name: Run tests with coverage
        run: npm run test:coverage

      - name: Upload coverage report
        uses: actions/upload-artifact@v4
        with:
          name: coverage-report
          path: coverage/
          retention-days: 7

  grading-checks:
    runs-on: ubuntu-latest
    needs: [integrity-check, test]
    if: always()

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: Install dependencies
        run: npm ci

      - name: Check required files exist
        id: files
        run: |
          echo "## üìÅ File Check" >> $GITHUB_STEP_SUMMARY

          MISSING_FILES=""
          REQUIRED_FILES=(
            "src/components/BookCard.tsx"
            "src/components/BookForm.tsx"
            "src/components/BookList.tsx"
            "src/api/bookApi.ts"
            "src/__tests__/BookCard.test.tsx"
            "src/__tests__/BookForm.test.tsx"
            "src/__tests__/BookList.test.tsx"
            "src/__tests__/bookApi.test.ts"
            "src/setupTests.ts"
            "vitest.config.ts"
            "tsconfig.json"
            "db.json"
            "README.md"
          )

          for file in "${REQUIRED_FILES[@]}"; do
            if [ -f "$file" ]; then
              echo "‚úÖ $file" >> $GITHUB_STEP_SUMMARY
            else
              echo "‚ùå $file (MISSING)" >> $GITHUB_STEP_SUMMARY
              MISSING_FILES="$MISSING_FILES $file"
            fi
          done

          if [ -n "$MISSING_FILES" ]; then
            echo "files_missing=true" >> $GITHUB_OUTPUT
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚ö†Ô∏è **Some required files are missing!**" >> $GITHUB_STEP_SUMMARY
          else
            echo "files_missing=false" >> $GITHUB_OUTPUT
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚úÖ **All required files present!**" >> $GITHUB_STEP_SUMMARY
          fi

      - name: Check test count
        id: test_count
        run: |
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## üß™ Test Count" >> $GITHUB_STEP_SUMMARY

          npm run test:run -- --reporter=json --outputFile=test-results.json 2>/dev/null || true

          if [ -f test-results.json ]; then
            TOTAL_TESTS=$(cat test-results.json | grep -o '"numTotalTests":[0-9]*' | grep -o '[0-9]*' || echo "0")
            PASSED_TESTS=$(cat test-results.json | grep -o '"numPassedTests":[0-9]*' | grep -o '[0-9]*' || echo "0")
          else
            TOTAL_TESTS=$(npm run test:run 2>&1 | grep -oP '\d+(?= tests?)' | tail -1 || echo "0")
            PASSED_TESTS=$TOTAL_TESTS
          fi

          echo "Total tests found: $TOTAL_TESTS" >> $GITHUB_STEP_SUMMARY
          echo "Passed tests: $PASSED_TESTS" >> $GITHUB_STEP_SUMMARY

          MIN_TESTS=30

          if [ "$TOTAL_TESTS" -ge "$MIN_TESTS" ]; then
            echo "‚úÖ **Test count meets minimum ($TOTAL_TESTS >= $MIN_TESTS)**" >> $GITHUB_STEP_SUMMARY
            echo "test_count_met=true" >> $GITHUB_OUTPUT
          else
            echo "‚ùå **Test count below minimum ($TOTAL_TESTS < $MIN_TESTS)**" >> $GITHUB_STEP_SUMMARY
            echo "test_count_met=false" >> $GITHUB_OUTPUT
          fi

      - name: Check coverage threshold
        id: coverage
        run: |
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## üìä Code Coverage" >> $GITHUB_STEP_SUMMARY

          npm run test:coverage 2>&1 | tee coverage-output.txt || true

          STATEMENTS=$(grep -oP 'Statements\s*:\s*\K[\d.]+' coverage-output.txt || echo "0")
          BRANCHES=$(grep -oP 'Branches\s*:\s*\K[\d.]+' coverage-output.txt || echo "0")
          FUNCTIONS=$(grep -oP 'Functions\s*:\s*\K[\d.]+' coverage-output.txt || echo "0")
          LINES=$(grep -oP 'Lines\s*:\s*\K[\d.]+' coverage-output.txt || echo "0")

          echo "| Metric | Coverage |" >> $GITHUB_STEP_SUMMARY
          echo "|--------|----------|" >> $GITHUB_STEP_SUMMARY
          echo "| Statements | ${STATEMENTS}% |" >> $GITHUB_STEP_SUMMARY
          echo "| Branches | ${BRANCHES}% |" >> $GITHUB_STEP_SUMMARY
          echo "| Functions | ${FUNCTIONS}% |" >> $GITHUB_STEP_SUMMARY
          echo "| Lines | ${LINES}% |" >> $GITHUB_STEP_SUMMARY

          THRESHOLD=90
          BELOW_THRESHOLD=false

          for coverage in $STATEMENTS $BRANCHES $FUNCTIONS $LINES; do
            if [ $(echo "$coverage < $THRESHOLD" | bc -l) -eq 1 ]; then
              BELOW_THRESHOLD=true
            fi
          done

          if [ "$BELOW_THRESHOLD" = "false" ]; then
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚úÖ **All coverage metrics meet ${THRESHOLD}% threshold**" >> $GITHUB_STEP_SUMMARY
            echo "coverage_met=true" >> $GITHUB_OUTPUT
          else
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚ö†Ô∏è **Some coverage metrics below ${THRESHOLD}% threshold**" >> $GITHUB_STEP_SUMMARY
            echo "coverage_met=false" >> $GITHUB_OUTPUT
          fi

      - name: Check README content
        id: readme
        run: |
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## üìù README Check" >> $GITHUB_STEP_SUMMARY

          README_ISSUES=""

          if grep -qi "reflection" README.md; then
            echo "‚úÖ Reflection section found" >> $GITHUB_STEP_SUMMARY
          else
            echo "‚ùå Missing reflection section" >> $GITHUB_STEP_SUMMARY
            README_ISSUES="$README_ISSUES reflection"
          fi

          if grep -qi "key concepts\|concepts learned\|what i learned" README.md; then
            echo "‚úÖ Key concepts section found" >> $GITHUB_STEP_SUMMARY
          else
            echo "‚ùå Missing key concepts section" >> $GITHUB_STEP_SUMMARY
            README_ISSUES="$README_ISSUES concepts"
          fi

          WORD_COUNT=$(wc -w < README.md)
          if [ "$WORD_COUNT" -ge 200 ]; then
            echo "‚úÖ README has sufficient content ($WORD_COUNT words)" >> $GITHUB_STEP_SUMMARY
          else
            echo "‚ö†Ô∏è README may be too short ($WORD_COUNT words, aim for 200+)" >> $GITHUB_STEP_SUMMARY
            README_ISSUES="$README_ISSUES length"
          fi

          if grep -qi "name:\|author:\|by:" README.md; then
            echo "‚úÖ Student name appears to be present" >> $GITHUB_STEP_SUMMARY
          else
            echo "‚ö†Ô∏è Student name may be missing" >> $GITHUB_STEP_SUMMARY
          fi

          if [ -z "$README_ISSUES" ]; then
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚úÖ **README meets requirements**" >> $GITHUB_STEP_SUMMARY
            echo "readme_complete=true" >> $GITHUB_OUTPUT
          else
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚ö†Ô∏è **README may need improvement**" >> $GITHUB_STEP_SUMMARY
            echo "readme_complete=false" >> $GITHUB_OUTPUT
          fi

      - name: Check API functions exist
        id: api_check
        run: |
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## üîå API Client Check" >> $GITHUB_STEP_SUMMARY

          API_FILE="src/api/bookApi.ts"
          API_ISSUES=""

          REQUIRED_FUNCTIONS=("fetchBooks" "fetchBookById" "createBook" "updateBook" "deleteBook")

          for func in "${REQUIRED_FUNCTIONS[@]}"; do
            if grep -q "export.*function $func\|export.*const $func" "$API_FILE" 2>/dev/null; then
              echo "‚úÖ \`$func\` found" >> $GITHUB_STEP_SUMMARY
            else
              echo "‚ùå \`$func\` missing" >> $GITHUB_STEP_SUMMARY
              API_ISSUES="$API_ISSUES $func"
            fi
          done

          REQUIRED_METHODS=("GET" "POST" "PUT" "DELETE")
          for method in POST PUT DELETE; do
            if grep -q "method:.*['\"]$method['\"]" "$API_FILE" 2>/dev/null; then
              echo "‚úÖ HTTP \`$method\` used" >> $GITHUB_STEP_SUMMARY
            else
              echo "‚ö†Ô∏è HTTP \`$method\` not found" >> $GITHUB_STEP_SUMMARY
              API_ISSUES="$API_ISSUES $method"
            fi
          done

          if grep -q "Content-Type.*application/json" "$API_FILE" 2>/dev/null; then
            echo "‚úÖ \`Content-Type: application/json\` header set" >> $GITHUB_STEP_SUMMARY
          else
            echo "‚ö†Ô∏è \`Content-Type\` header may be missing" >> $GITHUB_STEP_SUMMARY
            API_ISSUES="$API_ISSUES content-type"
          fi

          if [ -z "$API_ISSUES" ]; then
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚úÖ **API client meets requirements**" >> $GITHUB_STEP_SUMMARY
            echo "api_complete=true" >> $GITHUB_OUTPUT
          else
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚ö†Ô∏è **API client may need improvement**" >> $GITHUB_STEP_SUMMARY
            echo "api_complete=false" >> $GITHUB_OUTPUT
          fi

      - name: Generate grading summary
        run: |
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "---" >> $GITHUB_STEP_SUMMARY
          echo "## üìã Grading Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Criteria | Status |" >> $GITHUB_STEP_SUMMARY
          echo "|----------|--------|" >> $GITHUB_STEP_SUMMARY

          echo "| üîí Template Integrity | ${{ needs.integrity-check.result == 'success' && '‚úÖ Pass' || '‚ö†Ô∏è Review needed' }} |" >> $GITHUB_STEP_SUMMARY

          if [ "${{ steps.files.outputs.files_missing }}" = "false" ]; then
            echo "| Required Files | ‚úÖ Pass |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| Required Files | ‚ùå Missing files |" >> $GITHUB_STEP_SUMMARY
          fi

          if [ "${{ steps.test_count.outputs.test_count_met }}" = "true" ]; then
            echo "| Minimum Tests (30) | ‚úÖ Pass |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| Minimum Tests (30) | ‚ùå Below minimum |" >> $GITHUB_STEP_SUMMARY
          fi

          if [ "${{ steps.coverage.outputs.coverage_met }}" = "true" ]; then
            echo "| Coverage (90%) | ‚úÖ Pass |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| Coverage (90%) | ‚ö†Ô∏è Below threshold |" >> $GITHUB_STEP_SUMMARY
          fi

          if [ "${{ steps.readme.outputs.readme_complete }}" = "true" ]; then
            echo "| README Complete | ‚úÖ Pass |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| README Complete | ‚ö†Ô∏è Needs review |" >> $GITHUB_STEP_SUMMARY
          fi

          if [ "${{ steps.api_check.outputs.api_complete }}" = "true" ]; then
            echo "| API Client | ‚úÖ Pass |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| API Client | ‚ö†Ô∏è Needs review |" >> $GITHUB_STEP_SUMMARY
          fi

          echo "" >> $GITHUB_STEP_SUMMARY
          echo "*Note: This is an automated check. Manual review of reflection quality, code patterns, and HTTP understanding will also be performed.*" >> $GITHUB_STEP_SUMMARY
